"use strict";(self.webpackChunkkgenots=self.webpackChunkkgenots||[]).push([[69853],{69853:(e,t,i)=>{i.r(t),i.d(t,{dyte_debugger_audio:()=>n,dyte_debugger_screenshare:()=>d,dyte_debugger_video:()=>l});var s=i(65733),a=(i(21237),i(24555),i(68753)),o=i(8934),r=(i(60804),i(46503));const n=class{constructor(e){(0,s.r)(this,e),this.testProgress=(0,s.c)(this,"testProgress",7),this.lowVolCount=0,this.silenceCount=0,this.meeting=void 0,this.states=void 0,this.size=void 0,this.iconPack=a.d,this.t=(0,o.u)(),this.micMetadata={},this.micPreview=!1,this.speakerPreview=!1,this.audioTrackStats={lowVolume:!1,clip:!1,silence:!1,volume:0,timestamp:0},this.activeTab="Report",this.stage=0,this.mediaPermission="NOT_REQUESTED",this.speakerDevice=void 0,this.speakerTest="none"}connectedCallback(){this.meetingChanged(this.meeting),this.updateProgress()}disconnectedCallback(){var e;const{self:t,troubleshoot:i}=this.meeting;this.micPreview&&this.toggleMicTest(),this.speakerPreview&&this.toggleSpeakerTest(),null==t||t.removeListener("deviceUpdate",this.deviceUpdateListener),null==t||t.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null===(e=null==i?void 0:i.audio)||void 0===e||e.removeListener("audioTrackStats",this.audioTrackUpdateListener)}async meetingChanged(e){var t,i;if(!e)return;const{self:s,troubleshoot:a}=e;(null==s?void 0:s.audioTrack)&&await this.getTrackInfo(),null==s||s.on("deviceUpdate",this.deviceUpdateListener.bind(this)),s.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener.bind(this));const o=null===(t=null==s?void 0:s.mediaPermissions)||void 0===t?void 0:t.audio;this.mediaPermissionUpdateListener({kind:"audio",message:o}),null===(i=null==a?void 0:a.audio)||void 0===i||i.on("audioTrackStats",this.audioTrackUpdateListener.bind(this))}deviceUpdateListener({device:e,preview:t}){t||("audioInput"===e.kind&&(this.speakerDevice=e),"audiooutput"===e.kind&&this.getTrackInfo())}mediaPermissionUpdateListener({kind:e,message:t}){"audio"===e&&(this.mediaPermission=t,"ACCEPTED"!==this.mediaPermission&&(this.stage=0,this.updateProgress(),this.micPreview&&this.toggleMicTest(),this.speakerPreview&&this.toggleSpeakerTest()))}audioTrackUpdateListener(e){this.audioTrackStats=Object.assign(Object.assign({},e),{volume:this.normalizeVolume(null==e?void 0:e.volume)}),this.volumeEl&&(this.volumeEl.style.width=`${this.audioTrackStats.volume}%`)}setActiveTab(e){this.activeTab=e,this.updateProgress()}async toggleMicTest(){var e,t,i;const s=null===(e=this.meeting.troubleshoot)||void 0===e?void 0:e.audio;this.micPreview=!this.micPreview,this.micPreview?(await this.getTrackInfo(),s.stopTrackAnalysis(),await(null==s?void 0:s.startTrackAnalysis(!0))):(null===(i=null===(t=this.meeting.troubleshoot)||void 0===t?void 0:t.audio)||void 0===i||i.stopTrackAnalysis(),this.audioTrackStats.volume=0,this.volumeEl&&(this.volumeEl.style.width="5%"))}async toggleSpeakerTest(){var e,t,i,s;const a=null===(e=this.meeting.troubleshoot)||void 0===e?void 0:e.audio;if((null===(t=this.testAudioEl)||void 0===t?void 0:t.paused)?(this.testAudioEl.currentTime=.2,null===(i=this.testAudioEl)||void 0===i||i.play(),this.speakerPreview=!0,null==a||a.startTrackAnalysis(!0),this.testAudioEl.addEventListener("ended",(()=>{this.speakerPreview=!1,null==a||a.stopTrackAnalysis()}))):(null===(s=this.testAudioEl)||void 0===s||s.pause(),this.speakerPreview=!1,null==a||a.stopTrackAnalysis()),this.speakerPreview){const{self:e}=this.meeting,t=await(null==e?void 0:e.getSpeakerDevices());if(!t)return;this.speakerDevice=t[0],null==e||e.setDevice(t[0])}}async getTrackInfo(){var e,t;this.micMetadata=await(null===(t=null===(e=this.meeting.troubleshoot)||void 0===e?void 0:e.audio)||void 0===t?void 0:t.getTrackMetadata(!0))}changeStage(e){"ACCEPTED"===this.mediaPermission&&(e=Math.max(0,e),e=Math.min(2,e),this.stage=e,this.updateProgress(),this.micPreview&&this.toggleMicTest(),this.speakerPreview&&this.toggleSpeakerTest())}updateProgress(){"Troubleshoot"===this.activeTab?this.testProgress.emit(100*(this.stage+1)/3):this.testProgress.emit(0)}getAudioLevelStatus(){let e="All systems are functional.",t="checkmark",i="success";return this.detectLowVolume()&&(e="Low volume detected, please move closer to the device.",t="warning",i="warning"),this.audioTrackStats.clip&&(e="Clipping detected. Your audio may be noisy.",t="warning",i="error"),this.detectSilence()&&(e="Silence detected. Your device is not picking up audio.",t="warning",i="error"),(0,s.h)("div",{class:`row status-text ${i}`},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack[t]}),this.t(e))}getDeviceInformationStatus(){let e="All systems are functional.",t="checkmark",i="success";const{channelCount:a,channelInterpretation:o,channelType:r,outputs:n}=this.micMetadata;return("discrete"===o&&n>a||"STEREO"===r&&1===n||"QUAD"===r&&1===n||"QUAD"===r&&2===n)&&(e="Audio quality might be degraded.",t="warning",i="warning"),("MONO"===r&&a<1||"STEREO"===r&&a<2||"QUAD"===r&&a<4)&&(e="Looks like your device is not functioning properly.",t="warning",i="error"),(0,s.h)("div",{class:`row status-text ${i}`},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack[t]}),this.t(e))}getSpeakerTestStatus(){return"success"===this.speakerTest?"All systems are functional.":"failed"===this.speakerTest?"Test failed. Please ensure your system volume is not 0.":void 0}setSpeakerTestResult(e){this.speakerPreview&&this.toggleSpeakerTest(),this.speakerTest=e}boolToStr(e){return e?"Yes":"No"}formatLabel(e){const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}normalizeVolume(e=0){let t=.3;return e>t&&(t=e),Math.max(5,Math.round(100*e/(t-.001)))}detectLowVolume(){var e;return(null===(e=this.audioTrackStats)||void 0===e?void 0:e.lowVolume)?this.lowVolCount++:this.lowVolCount=0,this.lowVolCount>10}detectSilence(){var e;return(null===(e=this.audioTrackStats)||void 0===e?void 0:e.silence)?this.silenceCount++:this.silenceCount=0,this.silenceCount>5}render(){const e={meeting:this.meeting,states:this.states||r.s,iconPack:this.iconPack,t:this.t,size:this.size};return(0,s.h)(s.H,null,(0,s.h)("audio",{preload:"auto",src:"https://assets.dyte.io/ui-kit/speaker-test.mp3",ref:e=>this.testAudioEl=e}),(0,s.h)("div",{id:"header"},["Report","Troubleshoot"].map((e=>(0,s.h)("dyte-button",{key:e,variant:"ghost",class:{active:this.activeTab===e},onClick:()=>this.setActiveTab(e),iconPack:this.iconPack,t:this.t},this.t(e))))),"Troubleshoot"===this.activeTab&&(0,s.h)("div",{class:"tab-body"},(0,s.h)("div",null,(0,s.h)("div",{class:"stage-indicator"},"Step ",this.stage+1,"/3"),0===this.stage&&(0,s.h)("dyte-debugger-permissions-ui",Object.assign({},e,{mediaType:"audio"})),1===this.stage&&(0,s.h)("div",null,(0,s.h)("div",{class:"title"},"Microphone Test"),(0,s.h)("div",{class:"text"},this.t("Please start the microphone test and start speaking in order to test your audio device.")),(0,s.h)("dyte-button",{size:"md",onClick:()=>this.toggleMicTest()},this.micPreview?"Stop":"Start"," Microphone Test"),this.micPreview&&(0,s.h)("div",{class:"col"},(0,s.h)("div",{class:"sub-title"},"Device Information",(0,s.h)("dyte-information-tooltip",{iconPack:this.iconPack},(0,s.h)("div",{slot:"tootlip-text",class:"tooltip-text"},Object.keys(this.micMetadata).map((e=>(0,s.h)("div",null,this.formatLabel(e),": ",(0,s.h)("span",null,this.micMetadata[e]))))))),["label","channelType"].map((e=>{const t=this.micMetadata[e];if(t)return(0,s.h)("div",{class:"row"},(0,s.h)("div",{class:"label"},(0,s.h)("span",null,this.t(this.formatLabel(e))),":"),(0,s.h)("div",{class:"text"},this.t(t)))})),this.getDeviceInformationStatus(),(0,s.h)("div",{class:"sub-title"},"Audio Level Analysis",(0,s.h)("dyte-information-tooltip",{iconPack:this.iconPack},(0,s.h)("div",{slot:"tootlip-text",class:"tooltip-text"},(0,s.h)("div",null,"Volume Level:",(0,s.h)("span",null,this.audioTrackStats.volume,"/100")),(0,s.h)("div",null,"Low Volume:",(0,s.h)("span",null,this.boolToStr(this.audioTrackStats.lowVolume))),(0,s.h)("div",null,"Silence Detected:",(0,s.h)("span",null,this.boolToStr(this.audioTrackStats.silence))),(0,s.h)("div",null,"Noise Detected:",(0,s.h)("span",null,this.boolToStr(this.audioTrackStats.clip))),(0,s.h)("div",null,"Time:",(0,s.h)("span",null,new Date(this.audioTrackStats.timestamp).toLocaleTimeString()))))),(0,s.h)("div",{class:"row"},(0,s.h)("dyte-icon",{icon:this.iconPack.speaker,size:"md"}),(0,s.h)("div",{class:"volume-indicator"},(0,s.h)("div",{class:"volume-level",ref:e=>this.volumeEl=e}))),this.getAudioLevelStatus())),2===this.stage&&(0,s.h)("div",{class:"col"},(0,s.h)("div",{class:"title"},"Speaker Test"),(0,s.h)("div",{class:"text"},this.t("Upon starting this test, an audio will be played. Please ensure your system volume is not set to zero.")),(0,s.h)("dyte-button",{onClick:()=>this.toggleSpeakerTest(),size:"md"},this.speakerPreview?"Stop":"Start"," Speaker Test"),this.speakerDevice&&(0,s.h)("div",null,(0,s.h)("div",{class:"sub-title"},"Device Information"),(0,s.h)("div",{class:"row"},(0,s.h)("div",{class:"label"},(0,s.h)("span",null,"Label"),":"),(0,s.h)("div",{class:"text"},this.speakerDevice.label))),this.speakerPreview&&(0,s.h)("div",null,(0,s.h)("p",{class:"sub-title"},"Are you able to hear the audio?"),(0,s.h)("div",{class:"speaker-test"},(0,s.h)("dyte-button",{onClick:()=>this.setSpeakerTestResult("success"),size:"sm",variant:"primary"},"Yes"),(0,s.h)("dyte-button",{onClick:()=>this.setSpeakerTestResult("failed"),size:"sm",variant:"secondary"},"No"))),!this.speakerPreview&&"none"!==this.speakerTest&&(0,s.h)("div",{class:`row status-text ${this.speakerTest}`},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack["failed"===this.speakerTest?"dismiss":"checkmark"]}),this.getSpeakerTestStatus()))),(0,s.h)("div",{class:"stage-manager"},this.stage<2&&(0,s.h)("div",{class:{"stage-button":!0,disabled:"ACCEPTED"!==this.mediaPermission},onClick:()=>this.changeStage(this.stage+1)},"Next",(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.chevron_right})),this.stage>0&&(0,s.h)("div",{class:{"stage-button":!0,disabled:"ACCEPTED"!==this.mediaPermission},onClick:()=>this.changeStage(this.stage-1)},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.chevron_left}),"Prev"))),"Report"===this.activeTab&&(0,s.h)("div",{class:"tab-body"},(0,s.h)("dyte-debugger-issues-ui",Object.assign({},e,{mediaType:"audio"}))))}static get watchers(){return{meeting:["meetingChanged"]}}};n.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;height:100%;width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:600}.status{margin-left:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:12px}.status dyte-icon{margin-right:var(--dyte-space-2, 8px)}.scroll{overflow:auto;border-radius:var(--dyte-border-radius-none, 0)}.warning,.NOT_REQUESTED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity)) !important;opacity:0.8}.success,.ACCEPTED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity)) !important;opacity:0.8}.COULD_NOT_START,.error,.failed,.DENIED,.SYSTEM_DENIED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity)) !important;opacity:0.8}.row{display:flex;flex-direction:row;align-items:center;justify-content:flex-start}.section{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start}h3{margin:var(--dyte-space-0, 0px);font-size:14px;font-weight:600}.stage-indicator{margin-bottom:var(--dyte-space-1, 4px);display:flex;flex-direction:row;align-items:center;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.status-text{margin-top:var(--dyte-space-3, 12px);font-size:14px;font-weight:100 !important}.status-text dyte-icon{margin-right:var(--dyte-space-2, 8px)}.tooltip-text{display:flex;flex-direction:column;font-size:12px}.tooltip-text span{margin-left:var(--dyte-space-1, 4px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88)) !important}.tooltip-text div{margin-top:var(--dyte-space-1, 4px)}.tooltip-text div:nth-child(1){margin:var(--dyte-space-0, 0px)}.row{display:flex;flex-direction:row;align-items:center;justify-content:center}.row dyte-switch{margin-left:var(--dyte-space-8, 32px)}.row dyte-button{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-2, 8px)}.row .label{width:var(--dyte-space-40, 160px)}.row .text{margin-top:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-0, 0px)}.m3{margin-top:var(--dyte-space-3, 12px)}.m1{margin-top:var(--dyte-space-1, 4px)}.col{display:flex;width:100%;flex-direction:column;align-items:flex-start;justify-content:flex-start}.label{margin-top:var(--dyte-space-1, 4px);display:flex;flex-direction:row;justify-content:space-between;font-size:14px;font-weight:100 !important;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.text{margin-bottom:var(--dyte-space-2, 8px);font-size:14px;font-weight:100 !important;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));opacity:0.7}.title{margin-bottom:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;font-size:14px;font-weight:600;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.sub-title{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;font-size:14px;font-weight:600;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.error-text{margin-top:var(--dyte-space-1, 4px);display:flex;flex-direction:row;font-size:14px;font-weight:100 !important;--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.error-text dyte-icon{margin-right:var(--dyte-space-2, 8px)}.volume-indicator{margin-left:var(--dyte-space-4, 16px);height:var(--dyte-space-3, 12px);width:var(--dyte-space-56, 224px);overflow:hidden;border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.volume-level{height:var(--dyte-space-3, 12px);width:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-400, 53 110 253) / var(--tw-bg-opacity));transition:width 0.5s}.stage-manager{position:-webkit-sticky;position:sticky;bottom:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-4, 16px);display:flex;flex-direction:row-reverse;align-items:center;justify-content:space-between;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-text-opacity))}.stage-button{display:flex;cursor:pointer;flex-direction:row;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}.stage-button dyte-icon{padding:var(--dyte-space-0, 0px)}.disabled{cursor:not-allowed;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52)) !important}#header{margin-top:var(--dyte-space-2, 8px);display:flex;align-items:center;justify-content:space-evenly;border-bottom:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}#header dyte-button{border-bottom:var(--dyte-border-width-md, 2px) solid transparent;border-radius:var(--dyte-border-radius-none, 0)}#header dyte-button:hover{background-color:transparent}#header dyte-button.active{border-color:rgb(var(--dyte-colors-brand-400, 53 110 253))}.tab-body{display:flex;height:100%;flex-direction:column;justify-content:space-between;overflow-y:auto;padding:var(--dyte-space-4, 16px)}.speaker-test{margin-top:var(--dyte-space-4, 16px);display:flex;flex-direction:row}.speaker-test dyte-button{margin-right:var(--dyte-space-2, 8px)}";const d=class{constructor(e){(0,s.r)(this,e),this.testProgress=(0,s.c)(this,"testProgress",7),this.lowVolCount=0,this.silenceCount=0,this.frozenFramesCount=0,this.blackFramesCount=0,this.meeting=void 0,this.states=void 0,this.size=void 0,this.iconPack=a.d,this.t=(0,o.u)(),this.activeTab="Report",this.stage=0,this.mediaPermission="NOT_REQUESTED",this.screenshareEnabled=!1,this.audioTrackMetadata={},this.videoTrackMetadata={},this.screenshareTest=!1,this.audioTrackStats={lowVolume:!1,clip:!1,silence:!1,volume:0,timestamp:0},this.videoTrackStats={isBlackFrame:!1,isFrozenFrame:!1,timestamp:0,videoScore:0}}connectedCallback(){this.meetingChanged(this.meeting),this.updateProgress()}disconnectedCallback(){var e,t;const{self:i,troubleshoot:s}=this.meeting;this.screenshareTest&&this.toggleScreenshareTest(),null==i||i.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),i.removeListener("screenShareUpdate",this.screenShareUpdateListener),null===(e=null==s?void 0:s.screenshare)||void 0===e||e.removeListener("audioTrackStats",this.audioTrackUpdateListener),null===(t=null==s?void 0:s.screenshare)||void 0===t||t.removeListener("videoTrackStats",this.videoTrackUpdateListener)}async meetingChanged(e){var t,i,s;if(!e)return;const{self:a,troubleshoot:o}=e;a.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener.bind(this)),a.addListener("screenShareUpdate",this.screenShareUpdateListener.bind(this)),null===(t=null==o?void 0:o.screenshare)||void 0===t||t.on("audioTrackStats",this.audioTrackUpdateListener.bind(this)),null===(i=null==o?void 0:o.screenshare)||void 0===i||i.on("videoTrackStats",this.videoTrackUpdateListener.bind(this));const r=null===(s=null==a?void 0:a.mediaPermissions)||void 0===s?void 0:s.screenshare;this.mediaPermissionUpdateListener({kind:"screenshare",message:r});const n=null==a?void 0:a.screenShareEnabled;this.screenShareUpdateListener({screenShareEnabled:n})}mediaPermissionUpdateListener({kind:e,message:t}){"screenshare"===e&&(this.mediaPermission=t,"ACCEPTED"!==this.mediaPermission&&(this.stage=0,this.updateProgress()))}screenShareUpdateListener({screenShareEnabled:e}){this.screenshareEnabled=e,!this.screenshareEnabled&&this.screenshareTest&&this.toggleScreenshareTest()}audioTrackUpdateListener(e){this.audioTrackStats=Object.assign(Object.assign({},e),{volume:this.normalizeVolume(null==e?void 0:e.volume)})}videoTrackUpdateListener(e){this.videoTrackStats=Object.assign(Object.assign({},e),{videoScore:this.normalizeVideoScore(null==e?void 0:e.videoScore)})}async toggleScreenshareTest(){var e,t,i;this.screenshareTest=!this.screenshareTest;const s=null===(e=this.meeting)||void 0===e?void 0:e.troubleshoot.screenshare;this.screenshareTest&&this.screenshareEnabled?(this.audioTrackMetadata=null!==(t=null==s?void 0:s.getAudioTrackMetaData())&&void 0!==t?t:{},this.videoTrackMetadata=null!==(i=null==s?void 0:s.getVideoTrackMetaData())&&void 0!==i?i:{},await s.startAudioTrackAnalysis(),await s.startVideoTrackAnalysis()):(null==s||s.stopAudioTrackAnalysis(),null==s||s.stopVideoTrackAnalysis())}setActiveTab(e){this.activeTab=e,this.updateProgress()}changeStage(e){"ACCEPTED"===this.mediaPermission&&(e=Math.max(0,e),e=Math.min(1,e),this.stage=e,this.updateProgress(),this.screenshareTest&&this.toggleScreenshareTest())}updateProgress(){"Troubleshoot"===this.activeTab?this.testProgress.emit(100*(this.stage+1)/2):this.testProgress.emit(0)}getDeviceInformationStatus(){let e="All systems are functional.",t="checkmark",i="success";if(this.audioTrackMetadata){const{channelCount:s,channelInterpretation:a,channelType:o,outputs:r}=this.audioTrackMetadata;("discrete"===a&&r>s||"STEREO"===o&&1===r||"QUAD"===o&&1===r||"QUAD"===o&&2===r)&&(e="Audio quality might be degraded.",t="warning",i="warning"),("MONO"===o&&s<1||"STEREO"===o&&s<2||"QUAD"===o&&s<4)&&(e="Looks like your device is not functioning properly.",t="warning",i="error")}return(0,s.h)("div",{class:`row status-text ${i}`},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack[t]}),this.t(e))}getAudioAnalysisStatus(){var e;let t="All systems are functional.",i="checkmark",a="success";return(null===(e=this.audioTrackMetadata)||void 0===e?void 0:e.label)?(this.detectLowVolume()&&(t="Low volume detected.",i="warning",a="warning"),this.audioTrackStats.clip&&(t="Your audio may be noisy.",i="warning",a="error"),this.detectSilence()&&(t="Silence detected.",i="warning",a="error"),(0,s.h)("div",{class:`row status-text ${a}`},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack[i]}),this.t(t))):(0,s.h)("div",{class:"row status-text warning"},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.warning}),this.t("Not Available"))}getVideoAnalysisStatus(){var e,t;let i="All systems are functional.",a="checkmark",o="success";return(null===(e=this.videoTrackStats)||void 0===e?void 0:e.isBlackFrame)?this.blackFramesCount++:this.blackFramesCount=0,(null===(t=this.videoTrackStats)||void 0===t?void 0:t.isFrozenFrame)?this.frozenFramesCount++:this.frozenFramesCount=0,this.frozenFramesCount>4&&(i="Looks like the video is frozen.",a="warning",o="error"),this.blackFramesCount>4&&(i="Video is not being processed by the camera.",a="warning",o="error"),(0,s.h)("div",{class:`row status-text ${o}`},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack[a]}),this.t(i))}formatLabel(e){const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}nullToStr(e){return e||"Not Available"}normalizeVolume(e=0){let t=.3;return e>t&&(t=e),Math.max(5,Math.round(100*e/(t-.001)))}normalizeVideoScore(e=0){let t=1;return e>t&&(t=e),Math.max(5,Math.round(10*e/(t-0)))}detectLowVolume(){var e;return(null===(e=this.audioTrackStats)||void 0===e?void 0:e.lowVolume)?this.lowVolCount++:this.lowVolCount=0,this.lowVolCount>10}detectSilence(){var e;return(null===(e=this.audioTrackStats)||void 0===e?void 0:e.silence)?this.silenceCount++:this.silenceCount=0,this.silenceCount>5}render(){var e,t;const i={meeting:this.meeting,states:this.states||r.s,iconPack:this.iconPack,t:this.t,size:this.size};return(0,s.h)(s.H,null,(0,s.h)("div",{id:"header"},["Report","Troubleshoot"].map((e=>(0,s.h)("dyte-button",{key:e,variant:"ghost",class:{active:this.activeTab===e},onClick:()=>this.setActiveTab(e),iconPack:this.iconPack,t:this.t},this.t(e))))),"Troubleshoot"===this.activeTab&&(0,s.h)("div",{class:"tab-body"},(0,s.h)("div",null,(0,s.h)("div",{class:"stage-indicator"},"Step ",this.stage+1,"/2"),0===this.stage&&(0,s.h)("dyte-debugger-permissions-ui",Object.assign({},i,{mediaType:"screenshare"})),1===this.stage&&(this.screenshareEnabled?(0,s.h)("div",{class:"col"},(0,s.h)("div",{class:"text"},"Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots."),(0,s.h)("dyte-button",{onClick:()=>this.toggleScreenshareTest()},this.screenshareTest?"Stop":"Start"," Screenshare Tests"),this.screenshareTest&&(0,s.h)("div",null,(0,s.h)("div",{class:"sub-title"},"Device Information",(0,s.h)("dyte-information-tooltip",null,(0,s.h)("div",{slot:"tootlip-text",class:"tooltip-text"},Object.keys(this.audioTrackMetadata).map((e=>{if("label"!==e)return(0,s.h)("div",null,"Audio ",this.formatLabel(e),":"," ",(0,s.h)("span",null,this.audioTrackMetadata[e]))})),Object.keys(this.videoTrackMetadata).map((e=>{if("label"!==e)return(0,s.h)("div",null,"Video ",this.formatLabel(e),":"," ",(0,s.h)("span",null,JSON.stringify(this.videoTrackMetadata[e])))}))))),(0,s.h)("div",{class:"row align-start"},(0,s.h)("div",{class:"label"},(0,s.h)("span",null,"Audio Label"),":"),(0,s.h)("div",{class:"text"},this.nullToStr(null===(e=this.audioTrackMetadata)||void 0===e?void 0:e.label))),(0,s.h)("div",{class:"row align-start"},(0,s.h)("div",{class:"label"},(0,s.h)("span",null,"Video Label"),":"),(0,s.h)("div",{class:"text"},this.nullToStr(null===(t=this.videoTrackMetadata)||void 0===t?void 0:t.label))),this.getDeviceInformationStatus(),(0,s.h)("div",{class:"sub-title"},"Device Analysis"),(0,s.h)("div",{class:"row "},(0,s.h)("div",{class:"label"},(0,s.h)("span",null,"Audio Analysis")," :"),this.getAudioAnalysisStatus()),(0,s.h)("div",{class:"row"},(0,s.h)("div",{class:"label"},(0,s.h)("span",null,"Video Analysis")," :"),this.getVideoAnalysisStatus()))):(0,s.h)("div",{class:"col"},(0,s.h)("div",{class:"info"},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.warning}),"You are not sharing your screen."),(0,s.h)("div",{class:"text"},"In order for us to test your screenshare, you need to be sharing your screen. You can enable screenshare from the control bar.")))),(0,s.h)("div",{class:"stage-manager"},this.stage<1&&(0,s.h)("div",{class:{"stage-button":!0,disabled:"ACCEPTED"!==this.mediaPermission},onClick:()=>this.changeStage(this.stage+1)},"Next",(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.chevron_right})),this.stage>0&&(0,s.h)("div",{class:{"stage-button":!0,disabled:"ACCEPTED"!==this.mediaPermission},onClick:()=>this.changeStage(this.stage-1)},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.chevron_left}),"Prev"))),"Report"===this.activeTab&&(0,s.h)("div",{class:"tab-body"},(0,s.h)("dyte-debugger-issues-ui",Object.assign({},i,{mediaType:"screenshare"}))))}static get watchers(){return{meeting:["meetingChanged"]}}};d.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;height:100%;width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:600}.status{margin-left:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:12px}.status dyte-icon{margin-right:var(--dyte-space-2, 8px)}.stage-indicator{margin-bottom:var(--dyte-space-1, 4px);display:flex;flex-direction:row;align-items:center;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.scroll{overflow:auto;border-radius:var(--dyte-border-radius-none, 0)}.warning,.NOT_REQUESTED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity)) !important;opacity:0.8}.success,.ACCEPTED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity)) !important;opacity:0.8}.COULD_NOT_START,.error,.DENIED,.SYSTEM_DENIED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity)) !important;opacity:0.8}h3{margin:var(--dyte-space-0, 0px);font-size:14px;font-weight:600}.status-text{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);font-size:14px;font-weight:100 !important}.status-text dyte-icon{margin-right:var(--dyte-space-2, 8px)}.tooltip-text{display:flex;flex-direction:column;font-size:12px}.tooltip-text span{margin-left:var(--dyte-space-1, 4px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88)) !important}.tooltip-text div{margin-top:var(--dyte-space-1, 4px)}.tooltip-text div:nth-child(1){margin:var(--dyte-space-0, 0px)}.row{display:flex;width:100%;flex-direction:row;align-items:center;justify-content:flex-start}.row dyte-switch{margin-left:var(--dyte-space-8, 32px)}.row dyte-icon{margin-left:var(--dyte-space-2, 8px)}.row dyte-button{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-2, 8px)}.row .label{width:var(--dyte-space-28, 112px) !important;min-width:var(--dyte-space-28, 112px)}.row .text{margin-top:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-0, 0px)}.align-start{align-items:flex-start !important}.col{display:flex;width:100%;flex-direction:column;align-items:flex-start;justify-content:flex-start}.label{margin-top:var(--dyte-space-1, 4px);display:flex;flex-direction:row;justify-content:space-between;font-size:14px;font-weight:100 !important;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.info{margin-bottom:var(--dyte-space-2, 8px);display:flex;flex-direction:row;font-size:14px;font-weight:100 !important;--tw-text-opacity:1;color:rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity));opacity:0.7}.info dyte-icon{margin-right:var(--dyte-space-2, 8px)}.text{margin-bottom:var(--dyte-space-2, 8px);font-size:14px;font-weight:100 !important;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));opacity:0.7}.title{margin-bottom:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;font-size:14px;font-weight:600;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.sub-title{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;font-size:14px;font-weight:600;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.stage-manager{margin-top:var(--dyte-space-4, 16px);display:flex;width:100%;flex-direction:row-reverse;align-items:center;justify-content:space-between;align-self:flex-end;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-text-opacity))}.stage-button{display:flex;cursor:pointer;flex-direction:row;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}.stage-button dyte-icon{padding:var(--dyte-space-0, 0px)}.disabled{cursor:not-allowed;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52)) !important}#header{margin-top:var(--dyte-space-2, 8px);display:flex;align-items:center;justify-content:space-evenly;border-bottom:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}#header dyte-button{border-bottom:var(--dyte-border-width-md, 2px) solid transparent;border-radius:var(--dyte-border-radius-none, 0)}#header dyte-button:hover{background-color:transparent}#header dyte-button.active{border-color:rgb(var(--dyte-colors-brand-400, 53 110 253))}.tab-body{position:relative;display:flex;height:100%;flex-direction:column;justify-content:space-between;overflow-y:auto;padding:var(--dyte-space-4, 16px)}";const l=class{constructor(e){(0,s.r)(this,e),this.testProgress=(0,s.c)(this,"testProgress",7),this.blackFramesCount=0,this.meeting=void 0,this.states=void 0,this.size=void 0,this.iconPack=a.d,this.t=(0,o.u)(),this.activeTab="Report",this.stage=0,this.mediaPermission="NOT_REQUESTED",this.videoPreview=!1,this.videoMetadata={},this.videoTrackStats={isBlackFrame:!1,isFrozenFrame:!1,timestamp:0,videoScore:0}}connectedCallback(){this.meetingChanged(this.meeting),this.updateProgress()}disconnectedCallback(){var e;const{self:t,troubleshoot:i}=this.meeting;this.videoPreview&&this.toggleVideoTest(),null==t||t.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null===(e=null==i?void 0:i.video)||void 0===e||e.removeListener("videoTrackStats",this.videoTrackUpdateListener)}async meetingChanged(e){var t,i;if(!e)return;const{self:s,troubleshoot:a}=e;(null==s?void 0:s.videoTrack)&&await this.getTrackInfo(),null==s||s.on("deviceUpdate",this.deviceUpdateListner.bind(this)),s.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener.bind(this));const o=null===(t=null==s?void 0:s.mediaPermissions)||void 0===t?void 0:t.video;this.mediaPermissionUpdateListener({kind:"video",message:o}),null===(i=null==a?void 0:a.video)||void 0===i||i.on("videoTrackStats",this.videoTrackUpdateListener.bind(this))}mediaPermissionUpdateListener({kind:e,message:t}){"video"===e&&(this.mediaPermission=t,"ACCEPTED"!==this.mediaPermission&&(this.stage=0,this.updateProgress(),this.videoPreview&&this.toggleVideoTest()))}deviceUpdateListner({device:e,preview:t}){t||"videoinput"===(null==e?void 0:e.kind)&&this.getTrackInfo()}videoTrackUpdateListener(e){this.videoTrackStats=Object.assign(Object.assign({},e),{videoScore:this.normalizeVideoScore(null==e?void 0:e.videoScore)})}setActiveTab(e){this.activeTab=e,this.updateProgress()}async toggleVideoTest(){var e,t;this.videoPreview=!this.videoPreview;const i=null===(t=null===(e=this.meeting)||void 0===e?void 0:e.troubleshoot)||void 0===t?void 0:t.video;if(this.videoPreview){const e=await(null==i?void 0:i.startPreview()),t=new MediaStream;if(!e)return;t.addTrack(e),setTimeout((()=>{this.videoEl.srcObject=t}),500),this.getTrackInfo(),await(null==i?void 0:i.startTrackAnalysis())}else null==i||i.stopPreview(),null==i||i.stopTrackAnalysis(),this.videoEl.srcObject=void 0}getTrackInfo(){var e,t;this.videoMetadata=null===(t=null===(e=this.meeting.troubleshoot)||void 0===e?void 0:e.video)||void 0===t?void 0:t.getTrackMetadata()}getAnalysisStatus(){var e,t;let i="All systems are functional.",a="checkmark",o="success";return(null===(e=this.videoTrackStats)||void 0===e?void 0:e.isBlackFrame)?this.blackFramesCount++:this.blackFramesCount=0,(null===(t=this.videoTrackStats)||void 0===t?void 0:t.isFrozenFrame)&&(i="Looks like the video is frozen.",a="warning",o="error"),this.blackFramesCount>10&&(i="Video is not being processed by the camera.",a="warning",o="error"),(0,s.h)("div",{class:`row status-text ${o}`},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack[a]}),this.t(i))}changeStage(e){"ACCEPTED"===this.mediaPermission&&(e=Math.max(0,e),e=Math.min(1,e),this.stage=e,this.updateProgress(),this.videoPreview&&this.toggleVideoTest())}updateProgress(){"Troubleshoot"===this.activeTab?this.testProgress.emit(100*(this.stage+1)/2):this.testProgress.emit(0)}formatLabel(e){const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}boolToStr(e){return e?"Yes":"No"}normalizeVideoScore(e=0){let t=1;return e>t&&(t=e),Math.max(5,Math.round(10*e/(t-0)))}render(){const e={meeting:this.meeting,states:this.states||r.s,iconPack:this.iconPack,t:this.t,size:this.size};return(0,s.h)(s.H,null,(0,s.h)("div",{id:"header"},["Report","Troubleshoot"].map((e=>(0,s.h)("dyte-button",{key:e,variant:"ghost",class:{active:this.activeTab===e},onClick:()=>this.setActiveTab(e),iconPack:this.iconPack,t:this.t},this.t(e))))),"Troubleshoot"===this.activeTab&&(0,s.h)("div",{class:"tab-body"},(0,s.h)("div",null,(0,s.h)("div",{class:"stage-indicator"},"Step ",this.stage+1,"/2"),0===this.stage&&(0,s.h)("dyte-debugger-permissions-ui",Object.assign({},e,{mediaType:"video"})),1===this.stage&&(0,s.h)("div",null,(0,s.h)("div",{class:"title"},"Camera Test"),(0,s.h)("div",{class:"text"},this.t("Upon starting the Camera Test, a video preview will be enabled for you.")),(0,s.h)("dyte-button",{size:"md",onClick:()=>this.toggleVideoTest()},this.videoPreview?"Stop":"Start"," Camera Test"),this.videoPreview&&this.videoMetadata&&(0,s.h)("div",{class:"col"},(0,s.h)("div",{class:"sub-title"},"Device Information",(0,s.h)("dyte-information-tooltip",{iconPack:this.iconPack},(0,s.h)("div",{slot:"tootlip-text",class:"tooltip-text"},Object.keys(this.videoMetadata).map((e=>(0,s.h)("div",null,this.formatLabel(e),":",(0,s.h)("span",null,JSON.stringify(this.videoMetadata[e])))))))),(0,s.h)("div",{class:"row"},(0,s.h)("div",{class:"label"},(0,s.h)("span",null,this.t("Device Label")),":"),(0,s.h)("div",{class:"text"},this.t(this.videoMetadata.label))),(0,s.h)("div",{class:"sub-title"},"Video & Device Analysis",(0,s.h)("dyte-information-tooltip",{iconPack:this.iconPack},(0,s.h)("div",{slot:"tootlip-text",class:"tooltip-text"},(0,s.h)("div",null,"Video Score:",(0,s.h)("span",null,this.videoTrackStats.videoScore,"/10")),(0,s.h)("div",null,"Black Frame Detected:",(0,s.h)("span",null,this.boolToStr(this.videoTrackStats.isBlackFrame))),(0,s.h)("div",null,"Frozen Frame Detected:",(0,s.h)("span",null,this.boolToStr(this.videoTrackStats.isFrozenFrame))),(0,s.h)("div",null,"Time:",(0,s.h)("span",null,new Date(this.videoTrackStats.timestamp).toLocaleTimeString()))))),(0,s.h)("div",{class:"video-container"},!this.videoPreview&&(0,s.h)("div",{class:"no-video-preview"},(0,s.h)("dyte-icon",{icon:this.iconPack.video_off,size:"md"})),(0,s.h)("video",{ref:e=>this.videoEl=e,autoPlay:!0,playsInline:!0,muted:!0,class:"video-preview"})),this.getAnalysisStatus()))),(0,s.h)("div",{class:"stage-manager"},this.stage>0&&(0,s.h)("div",{class:{"stage-button":!0,disabled:"ACCEPTED"!==this.mediaPermission},onClick:()=>this.changeStage(this.stage-1)},(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.chevron_left}),"Prev"),this.stage<1&&(0,s.h)("div",{class:{"stage-button":!0,disabled:"ACCEPTED"!==this.mediaPermission},onClick:()=>this.changeStage(this.stage+1)},"Next",(0,s.h)("dyte-icon",{size:"sm",icon:this.iconPack.chevron_right})))),"Report"===this.activeTab&&(0,s.h)("div",{class:"tab-body"},(0,s.h)("dyte-debugger-issues-ui",Object.assign({},e,{mediaType:"video"}))))}static get watchers(){return{meeting:["meetingChanged"]}}};l.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;height:100%;width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:600}.status{margin-left:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:12px}.status dyte-icon{margin-right:var(--dyte-space-2, 8px)}.stage-indicator{margin-bottom:var(--dyte-space-1, 4px);display:flex;flex-direction:row;align-items:center;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.scroll{overflow:auto;border-radius:var(--dyte-border-radius-none, 0)}.warning,.NOT_REQUESTED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity)) !important;opacity:0.8}.success,.ACCEPTED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity)) !important;opacity:0.8}.COULD_NOT_START,.error,.DENIED,.SYSTEM_DENIED{--tw-text-opacity:1 !important;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity)) !important;opacity:0.8}.row{display:flex;flex-direction:row;align-items:center;justify-content:flex-start}h3{margin:var(--dyte-space-0, 0px);font-size:14px;font-weight:600}.status-text{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);font-size:14px;font-weight:100 !important}.status-text dyte-icon{margin-right:var(--dyte-space-2, 8px)}.tooltip-text{display:flex;flex-direction:column;font-size:12px}.tooltip-text span{margin-left:var(--dyte-space-1, 4px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88)) !important}.tooltip-text div{margin-top:var(--dyte-space-1, 4px)}.tooltip-text div:nth-child(1){margin:var(--dyte-space-0, 0px)}.row{display:flex;flex-direction:row;align-items:center;justify-content:center}.row dyte-switch{margin-left:var(--dyte-space-8, 32px)}.row dyte-button{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-2, 8px)}.row .label{width:var(--dyte-space-40, 160px)}.row .text{margin-top:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-0, 0px)}.col{display:flex;width:100%;flex-direction:column;align-items:flex-start;justify-content:flex-start}.label{margin-top:var(--dyte-space-1, 4px);display:flex;flex-direction:row;justify-content:space-between;font-size:14px;font-weight:100 !important;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.text{margin-bottom:var(--dyte-space-2, 8px);font-size:14px;font-weight:100 !important;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));opacity:0.7}.title{margin-bottom:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;font-size:14px;font-weight:600;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.sub-title{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-2, 8px);display:flex;flex-direction:row;align-items:center;font-size:14px;font-weight:600;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.stage-manager{position:-webkit-sticky;position:sticky;bottom:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-4, 16px);display:flex;width:100%;flex-direction:row-reverse;align-items:center;justify-content:space-between;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-text-opacity))}.stage-button{display:flex;cursor:pointer;flex-direction:row;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}.stage-button dyte-icon{padding:var(--dyte-space-0, 0px)}.disabled{cursor:not-allowed;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52)) !important}.video-container{position:relative;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.no-video-preview{position:absolute;top:50%;left:50%;z-index:50;display:flex;height:var(--dyte-space-12, 48px);width:var(--dyte-space-12, 48px);align-items:center;justify-content:center;border-radius:50%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));translate:-50% -50%}.video-preview{margin-top:var(--dyte-space-1, 4px);aspect-ratio:16 / 9;height:var(--dyte-space-28, 112px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}video{transform:scaleX(-1)}#header{margin-top:var(--dyte-space-2, 8px);display:flex;align-items:center;justify-content:space-evenly;border-bottom:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}#header dyte-button{border-bottom:var(--dyte-border-width-md, 2px) solid transparent;border-radius:var(--dyte-border-radius-none, 0)}#header dyte-button:hover{background-color:transparent}#header dyte-button.active{border-color:rgb(var(--dyte-colors-brand-400, 53 110 253))}.tab-body{display:flex;height:100%;flex-direction:column;justify-content:space-between;overflow-y:auto;padding:var(--dyte-space-4, 16px)}"},60804:(e,t,i)=>{i.d(t,{g:()=>o});const s={get:(e,t,i)=>(...s)=>{try{return Reflect.get(e,t,i).apply(e,s)}catch(a){return null}}};let a;try{a=new Proxy(localStorage,s)}catch(r){a=new Proxy({},s)}const o=a},24555:(e,t,i)=>{i.d(t,{P:()=>r,a:()=>s,b:()=>h,c:()=>c,d:()=>n,e:()=>d,f:()=>l,i:()=>a,s:()=>o});const s=e=>!!o(e)&&("LIVESTREAM"===e.meta.viewType&&"ON_STAGE"!==e.stage.status),a=e=>{var t;return!!o(e)&&("LIVESTREAM"===e.meta.viewType&&(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.canLivestream))},o=e=>{var t;return(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.isV2)&&(null==e?void 0:e.livestream)};var r,n;!function(e){e.BUFFERING="Buffering",e.ENDED="Ended",e.IDLE="Idle",e.PLAYING="Playing",e.READY="Ready"}(r||(r={})),function(e){e.INITIALIZED="PlayerInitialized",e.QUALITY_CHANGED="PlayerQualityChanged",e.DURATION_CHANGED="PlayerDurationChanged",e.VOLUME_CHANGED="PlayerVolumeChanged",e.MUTED_CHANGED="PlayerMutedChanged",e.PLAYBACK_RATE_CHANGED="PlayerPlaybackRateChanged",e.REBUFFERING="PlayerRebuffering",e.AUDIO_BLOCKED="PlayerAudioBlocked",e.PLAYBACK_BLOCKED="PlayerPlaybackBlocked",e.ERROR="PlayerError",e.RECOVERABLE_ERROR="PlayerRecoverableError",e.ANALYTICS_EVENT="PlayerAnalyticsEvent",e.TIME_UPDATE="PlayerTimeUpdate",e.BUFFER_UPDATE="PlayerBufferUpdate",e.SEEK_COMPLETED="PlayerSeekCompleted",e.SESSION_DATA="PlayerSessionData",e.STATE_CHANGED="PlayerStateChanged",e.WORKER_ERROR="PlayerWorkerError",e.METADATA="PlayerMetadata",e.TEXT_CUE="PlayerTextCue",e.TEXT_METADATA_CUE="PlayerTextMetadataCue",e.AD_CUE="PlayerAdCue",e.STREAM_SOURCE_CUE="PlayerStreamSourceCue",e.NETWORK_UNAVAILABLE="PlayerNetworkUnavailable",e.SEGMENT_DISCONTINUITY="PlayerSegmentDiscontinuity",e.SEGMENT_METADATA="PlayerSegmentMetadata",e.PLAYER_METADATA="PlayerMetadata"}(n||(n={}));const d=[n.TIME_UPDATE,n.BUFFER_UPDATE,n.TEXT_METADATA_CUE,n.PLAYER_METADATA],l=[n.REBUFFERING,n.AUDIO_BLOCKED,n.PLAYBACK_BLOCKED,n.ERROR,n.RECOVERABLE_ERROR,n.WORKER_ERROR,n.NETWORK_UNAVAILABLE,n.ANALYTICS_EVENT,n.PLAYBACK_RATE_CHANGED,n.QUALITY_CHANGED,n.INITIALIZED],c=e=>{var t,i,s,a,r,n;return!!o(e)&&("ALLOWED"===(null===(i=null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.canProduceAudio)||"ALLOWED"===(null===(a=null===(s=null==e?void 0:e.self)||void 0===s?void 0:s.permissions)||void 0===a?void 0:a.canProduceScreenshare)||"ALLOWED"===(null===(n=null===(r=null==e?void 0:e.self)||void 0===r?void 0:r.permissions)||void 0===n?void 0:n.canProduceVideo))},h=e=>{var t,i,s,a,r,n,d,l;return!!o(e)&&("NOT_ALLOWED"!==(null===(i=null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.canProduceAudio)||"NOT_ALLOWED"!==(null===(a=null===(s=null==e?void 0:e.self)||void 0===s?void 0:s.permissions)||void 0===a?void 0:a.canProduceScreenshare)||"NOT_ALLOWED"!==(null===(n=null===(r=null==e?void 0:e.self)||void 0===r?void 0:r.permissions)||void 0===n?void 0:n.canProduceVideo)||(null===(l=null===(d=null==e?void 0:e.self)||void 0===d?void 0:d.permissions)||void 0===l?void 0:l.canLivestream))}},21237:(e,t,i)=>{i.d(t,{P:()=>r,s:()=>n});const s=720,a=1280,o=(e,t,i,s,a,o)=>{const r=a,n=o,d=Math.min(i/r,s/n);let l,c,h,p,v=r*d,u=n*d,g=1;return v<i&&(g=i/v),Math.abs(g-1)<1e-14&&u<s&&(g=s/u),v*=g,u*=g,h=r/(v/i),p=n/(u/s),l=.5*(r-h),c=.5*(n-p),l<0&&(l=0),c<0&&(c=0),h>r&&(h=r),p>n&&(p=n),[l,c,h,p,e,t,i,s]};var r;!function(e){e.CAMERA="CAMERA",e.MIC="MIC",e.END="END"}(r||(r={}));const n=new class{constructor(){this.tracks=[],this.sources=[],this.enabled=!1}isSupported(){return!!window.chrome&&document.pictureInPictureEnabled}cleanup(){this.isSupported()&&void 0!==document.exitPictureInPicture&&null!==document.pictureInPictureElement&&document.exitPictureInPicture(),this.canvas=void 0,this.video=void 0,this.tracks=[],this.request=void 0}createCanvas(){const e=document.createElement("canvas");e.height=s,e.width=a,this.canvas=e}setupEvents(e){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("hangup",(()=>{e(r.END)}))}mountAudioEvents(e){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglemicrophone",(()=>{e(r.MIC)}))}mountVideoEvents(e){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglecamera",(()=>{e(r.CAMERA)}))}unmountAudioEvents(){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglemicrophone",void 0)}unmountVideoEvents(){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglecamera",void 0)}drawGrid(e,t,i){if(void 0===this.canvas)return;const r=this.canvas.getContext("2d");r.fillStyle="#000000",r.fillRect(0,0,a,s);let n=0,d=0;for(;n<715;){let s=0;for(;s<1275&&d<i;){const i=this.tracks[d],[a,l,c,h,p,v,u,g]=o(s,n,e,t,i.videoWidth,i.videoHeight);r.drawImage(i,a,l,c,h,p,v,u,g),d+=1,s+=e}n+=t}}paintCanvas(){const e=this.tracks.length,[t,i]=(e=>{switch(e){case 0:case 1:return[a,s];case 2:return[Math.floor(640),s];case 3:case 4:return[Math.floor(640),Math.floor(360)];default:return[Math.floor(426.6666666666667),Math.floor(360)]}})(e);this.drawGrid(t,i,e)}animate(){void 0!==this.tracks&&this.paintCanvas(),void 0!==this.request&&(this.request=requestAnimationFrame((()=>this.animate())))}create(e,t,i){this.cleanup(),this.createCanvas(),this.setupEvents(i);const o=document.createElement("video");o.height=s,o.width=a,o.autoplay=!0,o.srcObject=this.canvas.captureStream(24),this.video=o,this.video.onloadedmetadata=()=>{try{e(),this.video.onleavepictureinpicture=()=>{t()}}catch(i){t(i.getMessage())}},this.paintCanvas()}updateMediaSession(e,t){void 0!==navigator.mediaSession&&(e===r.CAMERA&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setCameraActive(t),e===r.MIC&&void 0!==navigator.mediaSession.setMicrophoneActive&&navigator.mediaSession.setMicrophoneActive(t))}updateVideoSources(){const e=Object.values(this.sources).filter((e=>e.enabled)),t=[];e.map((e=>{t.push(e.element)})),this.tracks=t}enableSource(e){void 0!==this.sources[e]&&(this.sources[e].enabled=!0),this.updateVideoSources()}disableSource(e){void 0!==this.sources[e]&&(this.sources[e].enabled=!1),this.updateVideoSources()}addSource(e,t,i){this.sources[e]={element:t,enabled:i}}removeSource(e){delete this.sources[e]}removeAllSource(){this.sources=[]}enable(){this.enabled=!0,this.request=requestAnimationFrame((()=>this.animate())),this.video.requestPictureInPicture()}disable(){this.enabled=!1,cancelAnimationFrame(this.request),this.request=void 0,document.exitPictureInPicture()}}},46503:(e,t,i)=>{i.d(t,{o:()=>l,s:()=>d});var s=i(65733);const a=e=>!("isConnected"in e)||e.isConnected,o=((e,t)=>{let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...s)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(a))}),2e3),r=e=>"function"==typeof e?e():e,n=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)},{state:d,onChange:l}=((e,t)=>{const i=((e,t=((e,t)=>e!==t))=>{const i=r(e);let s=new Map(Object.entries(null!=i?i:{}));const a={dispose:[],get:[],set:[],reset:[]},o=()=>{var t;s=new Map(Object.entries(null!==(t=r(e))&&void 0!==t?t:{})),a.reset.forEach((e=>e()))},d=e=>(a.get.forEach((t=>t(e))),s.get(e)),l=(e,i)=>{const o=s.get(e);t(i,o,e)&&(s.set(e,i),a.set.forEach((t=>t(e,i,o))))},c="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>d(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,i)=>(l(t,i),!0)}),h=(e,t)=>(a[e].push(t),()=>{n(a[e],t)});return{state:c,get:d,set:l,on:h,onChange:(t,i)=>{const s=h("set",((e,s)=>{e===t&&i(s)})),a=h("reset",(()=>i(r(e)[t])));return()=>{s(),a()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(h("set",t.set)),t.get&&e.push(h("get",t.get)),t.reset&&e.push(h("reset",t.reset)),t.dispose&&e.push(h("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{a.dispose.forEach((e=>e())),o()},reset:o,forceUpdate:e=>{const t=s.get(e);a.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{if("function"!=typeof s.a)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=(0,s.a)();i&&((e,t,i)=>{const s=e.get(t);s?s.includes(i)||s.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(s.f)),o(e)},reset:()=>{e.forEach((e=>e.forEach(s.f))),o(e)}}})()),i})({})}}]);