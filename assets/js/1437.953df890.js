"use strict";(self.webpackChunkgithub_web=self.webpackChunkgithub_web||[]).push([[1437,3818],{63423:(t,e,s)=>{s.d(e,{c:()=>n});var i=s(16858);function n(t){return structuredClone?structuredClone(t):(0,i.c)(t)}},31437:(t,e,s)=>{s.r(e),s.d(e,{dyte_transcripts:()=>h});var i=s(44709),n=s(12844),r=s(45177),a=(s(35755),s(53459)),c=(s(92337),s(40548),s(63423));s(91137),s(89050),s(16858),s(33445),s(1844);const h=class{constructor(t){(0,i.r)(this,t),this.onTranscript=t=>{t.transcript&&this.add(t)},this.meeting=void 0,this.states=r.s,this.config=a.d,this.t=(0,n.u)(),this.transcripts=[],this.listenerAttached=!1}connectedCallback(){this.meetingChanged(this.meeting)}addListener(t){var e;null===(e=null==t?void 0:t.ai)||void 0===e||e.addListener("transcript",this.onTranscript),this.listenerAttached=!0}clearListeners(t){var e;this.onTranscript&&(null===(e=null==t?void 0:t.ai)||void 0===e||e.removeListener("transcript",this.onTranscript)),this.listenerAttached=!1,clearTimeout(this.disconnectTimeout),this.transcripts=[]}disconnectedCallback(){null!=this.meeting&&this.clearListeners(this.meeting)}meetingChanged(t,e){clearTimeout(this.disconnectTimeout),void 0!==e&&this.clearListeners(e),null!=t&&this.states.activeCaptions&&this.addListener(t)}statesChanged(t){const e=t||r.s;e.activeCaptions&&!this.listenerAttached&&this.addListener(this.meeting),!e.activeCaptions&&this.listenerAttached&&this.clearListeners(this.meeting)}transcriptionsReducer(t,e){if(!t.length)return[e];let s=t[t.length-1];if(s.peerId!==e.peerId)return t.concat(e);return s.transcript.length+e.transcript.length>400?t.concat(e):(s.transcript+=" "+e.transcript,t.pop(),t.concat((0,c.c)(s)))}add(t){this.transcripts.splice(0,this.transcripts.length-2),this.transcripts=this.transcriptionsReducer(this.transcripts,t)}remove(t){this.transcripts=this.transcripts.filter((e=>e.id!==t))}handleDismiss(t){t.stopPropagation();const e=t.detail,s=this.host.shadowRoot.querySelector(`[data-id="${e}"]`);null==s||s.classList.add("exit"),setTimeout((()=>{(0,i.w)((()=>{this.remove(e)}))}),400)}render(){var t;if(this.states.activeCaptions)return(0,i.h)(i.H,null,null===(t=this.transcripts)||void 0===t?void 0:t.map((t=>(0,i.h)("dyte-transcript",{key:t.id,"data-id":t.id,transcript:t,onDyteTranscriptDismiss:t=>this.handleDismiss(t),t:this.t}))))}get host(){return(0,i.a)(this)}static get watchers(){return{meeting:["meetingChanged"],states:["statesChanged"]}}};h.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;justify-content:center;width:100%;z-index:5}dyte-transcript{margin-top:var(--dyte-space-2, 8px)}"}}]);