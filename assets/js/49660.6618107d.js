"use strict";(self.webpackChunkdyte_docs=self.webpackChunkdyte_docs||[]).push([[49660],{49660:(e,t,r)=>{r.r(t),r.d(t,{dyte_channel_creator:()=>n});var a=r(65733),s=(r(21237),r(24555),r(96633)),i=r(20336),o=(r(60804),r(46503));const n=class{constructor(e){(0,a.r)(this,e),this.stateUpdate=(0,a.c)(this,"dyteStateUpdate",7),this.switchChannel=(0,a.c)(this,"switchChannel",7),this.allMembers=new Map,this.inputTextRef=null,this.searchInputTextRef=null,this.focusOnSearch=(e=!1)=>{this.focusedMemberIndex=-1,(0,a.w)((()=>{var t,r;null===(t=this.searchInputTextRef)||void 0===t||t.focus(),e&&(null===(r=this.searchInputTextRef)||void 0===r||r.select())}))},this.onClickHandler=async()=>{if(0!==this.channelName.length){if(1===this.step){const e=this.meeting.participants.all,t=this.meeting.self.userId;return e.filter((e=>e.id!==t)).forEach((e=>this.allMembers.set(e.id,e))),this.step=2,void this.focusOnSearch()}await this.createChannel()}},this.createChannel=async()=>{const e=Array.from(this.selectedMemberIds),t=await this.meeting.chat.createChannel(this.channelName,e,{displayPictureUrl:"",visibility:"public",isDirectMessage:!1});this.switchChannel.emit(t.id),this.stateUpdate.emit({activeChannelCreator:!1}),o.s.activeChannelCreator=!1},this.onMemberAdd=e=>{this.showAllMembersList=!1,this.selectedMemberIds.add(e),this.searchQuery="",this.focusOnSearch()},this.keyDownHandler=(e,t)=>{if("ArrowDown"===e.key)this.focusedMemberIndex=Math.min(this.focusedMemberIndex+1,t.length-1);else if("ArrowUp"===e.key){if(-1===this.focusedMemberIndex)return;if(0===this.focusedMemberIndex)return void this.focusOnSearch(!0);this.focusedMemberIndex=Math.max(this.focusedMemberIndex-1,0)}else if("Enter"===e.key)this.onMemberAdd(t[this.focusedMemberIndex].id);else if("Backspace"===e.key){if(0!==this.searchQuery.length)return;if(0===this.selectedMemberIds.size)return;const e=Array.from(this.selectedMemberIds.values()).at(-1);this.selectedMemberIds.delete(e),(0,a.f)(this.$el)}},this.renderMemberSelector=()=>{const e=Array.from(this.allMembers.values()).filter((e=>!this.selectedMemberIds.has(e.id)&&e.name.toLowerCase().includes(this.searchQuery.toLowerCase()))),t=Array.from(this.selectedMemberIds.values()).map((e=>this.allMembers.get(e))),r=this.selectedMemberIds.size===this.allMembers.size;return(0,a.h)("div",{class:"input-container"},(0,a.h)("ul",{class:"members",onClick:()=>{var e;null===(e=this.searchInputTextRef)||void 0===e||e.focus()}},t.map((e=>(0,a.h)("li",{class:"pill"},(0,a.h)("dyte-avatar",{participant:{name:e.name,picture:e.picture},size:"sm"}),(0,a.h)("span",null,e.name),(0,a.h)("dyte-icon",{icon:this.iconPack.dismiss,iconPack:this.iconPack,t:this.t,onClick:()=>{this.selectedMemberIds.delete(e.id),(0,a.f)(this.$el),this.focusOnSearch()}})))),!r&&(0,a.h)("input",{type:"text",ref:e=>this.searchInputTextRef=e,value:this.searchQuery,placeholder:0===this.selectedMemberIds.size?this.t("chat.member_name"):"",class:{"wide-input":0===this.selectedMemberIds.size},onInput:e=>{this.searchQuery=e.target.value.trim()},onClick:()=>{this.showAllMembersList=!this.showAllMembersList},onKeyDown:t=>this.keyDownHandler(t,e)})),(0!==this.searchQuery.length||this.showAllMembersList)&&(0,a.h)("ul",{class:"search-results"},e.map(((e,t)=>(0,a.h)("li",{class:{member:!0,selected:t===this.focusedMemberIndex},onClick:()=>this.onMemberAdd(e.id),ref:e=>{t===this.focusedMemberIndex&&(0,a.w)((()=>{e&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}))}},(0,a.h)("dyte-avatar",{participant:{name:e.name,picture:e.picture},size:"sm"}),(0,a.h)("span",null,e.name)))),0===e.length&&(0,a.h)("li",{class:"member"},(0,a.h)("span",null,this.t("chat.error.empty_results")))))},this.meeting=void 0,this.t=(0,i.u)(),this.iconPack=s.d,this.channelName="",this.searchQuery="",this.step=1,this.loading=!1,this.selectedMemberIds=new Set,this.focusedMemberIndex=-1,this.showAllMembersList=!1}componentDidLoad(){var e;null===(e=this.inputTextRef)||void 0===e||e.focus()}render(){return(0,a.h)(a.H,null,(0,a.h)("header",null,1===this.step?this.t("chat.new_channel"):this.t("chat.add_members")),1===this.step&&(0,a.h)("input",{class:"channel-name-input",type:"text",placeholder:this.t("chat.channel_name"),ref:e=>this.inputTextRef=e,onInput:e=>{this.channelName=e.target.value.trim()}}),2===this.step&&this.renderMemberSelector(),(0,a.h)("footer",null,(0,a.h)("dyte-button",{kind:"button",iconPack:this.iconPack,t:this.t,size:"lg",disabled:0===this.channelName.length,onClick:this.onClickHandler},1===this.step?this.t("chat.add_members"):this.t("create"))))}get $el(){return(0,a.g)(this)}};n.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));display:flex;flex-direction:column;width:var(--dyte-space-96, 384px);padding-left:var(--dyte-space-9, 36px);padding-right:var(--dyte-space-9, 36px);padding-top:var(--dyte-space-10, 40px);padding-bottom:var(--dyte-space-10, 40px)}header{margin-bottom:var(--dyte-space-8, 32px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px);font-size:24px;font-weight:600}.channel-name-input{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-3, 12px);font-size:16px;-webkit-appearance:none;-moz-appearance:none;appearance:none;line-height:1.25;outline:2px solid transparent;outline-offset:2px}.channel-name-input:focus{outline-width:2px;outline-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}footer{margin-top:var(--dyte-space-5, 20px);display:flex;justify-content:flex-end}.member{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding:var(--dyte-space-2, 8px)}.member dyte-avatar{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.input-container{position:relative;-webkit-appearance:none;-moz-appearance:none;appearance:none;line-height:1.25;outline:2px solid transparent;outline-offset:2px;outline-width:2px;outline-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5);border-radius:var(--dyte-border-radius-sm, 4px)}.input-container .members{margin:var(--dyte-space-0, 0px);max-height:var(--dyte-space-28, 112px);border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);list-style-type:none;display:flex;flex-wrap:wrap;gap:var(--dyte-space-1, 4px);cursor:text;font-size:16px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));overflow-y:auto}.input-container .pill{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.input-container .pill dyte-avatar{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.input-container .pill span{max-width:var(--dyte-space-32, 128px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.input-container .pill dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);cursor:pointer}.input-container input{width:var(--dyte-space-24, 96px);border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-1, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));outline:2px solid transparent;outline-offset:2px;font-size:16px;line-height:1.25rem}.input-container input.wide-input{width:100%}.search-results{margin:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-1, 4px);max-height:var(--dyte-space-28, 112px);width:100%;padding:var(--dyte-space-0, 0px);position:absolute;list-style-type:none;overflow-y:auto;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-md, 8px);--tw-border-spacing-x:var(--dyte-space-2, 8px);--tw-border-spacing-y:var(--dyte-space-2, 8px);border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-style:solid;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.search-results .member{cursor:pointer}.search-results .member dyte-avatar{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.search-results .member:hover,.search-results .member.selected{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-700, 2 70 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}"},60804:(e,t,r)=>{r.d(t,{g:()=>i});const a={get:(e,t,r)=>(...a)=>{try{return Reflect.get(e,t,r).apply(e,a)}catch(s){return null}}};let s;try{s=new Proxy(localStorage,a)}catch(o){s=new Proxy({},a)}const i=s},24555:(e,t,r)=>{r.d(t,{P:()=>o,a:()=>a,b:()=>h,c:()=>l,d:()=>n,e:()=>d,f:()=>c,i:()=>s,s:()=>i});const a=e=>!!i(e)&&("LIVESTREAM"===e.meta.viewType&&"ON_STAGE"!==e.stage.status),s=e=>{var t;return!!i(e)&&("LIVESTREAM"===e.meta.viewType&&(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.canLivestream))},i=e=>{var t;return(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.isV2)&&(null==e?void 0:e.livestream)};var o,n;!function(e){e.BUFFERING="Buffering",e.ENDED="Ended",e.IDLE="Idle",e.PLAYING="Playing",e.READY="Ready"}(o||(o={})),function(e){e.INITIALIZED="PlayerInitialized",e.QUALITY_CHANGED="PlayerQualityChanged",e.DURATION_CHANGED="PlayerDurationChanged",e.VOLUME_CHANGED="PlayerVolumeChanged",e.MUTED_CHANGED="PlayerMutedChanged",e.PLAYBACK_RATE_CHANGED="PlayerPlaybackRateChanged",e.REBUFFERING="PlayerRebuffering",e.AUDIO_BLOCKED="PlayerAudioBlocked",e.PLAYBACK_BLOCKED="PlayerPlaybackBlocked",e.ERROR="PlayerError",e.RECOVERABLE_ERROR="PlayerRecoverableError",e.ANALYTICS_EVENT="PlayerAnalyticsEvent",e.TIME_UPDATE="PlayerTimeUpdate",e.BUFFER_UPDATE="PlayerBufferUpdate",e.SEEK_COMPLETED="PlayerSeekCompleted",e.SESSION_DATA="PlayerSessionData",e.STATE_CHANGED="PlayerStateChanged",e.WORKER_ERROR="PlayerWorkerError",e.METADATA="PlayerMetadata",e.TEXT_CUE="PlayerTextCue",e.TEXT_METADATA_CUE="PlayerTextMetadataCue",e.AD_CUE="PlayerAdCue",e.STREAM_SOURCE_CUE="PlayerStreamSourceCue",e.NETWORK_UNAVAILABLE="PlayerNetworkUnavailable",e.SEGMENT_DISCONTINUITY="PlayerSegmentDiscontinuity",e.SEGMENT_METADATA="PlayerSegmentMetadata",e.PLAYER_METADATA="PlayerMetadata"}(n||(n={}));const d=[n.TIME_UPDATE,n.BUFFER_UPDATE,n.TEXT_METADATA_CUE,n.PLAYER_METADATA],c=[n.REBUFFERING,n.AUDIO_BLOCKED,n.PLAYBACK_BLOCKED,n.ERROR,n.RECOVERABLE_ERROR,n.WORKER_ERROR,n.NETWORK_UNAVAILABLE,n.ANALYTICS_EVENT,n.PLAYBACK_RATE_CHANGED,n.QUALITY_CHANGED,n.INITIALIZED],l=e=>{var t,r,a,s,o,n;return!!i(e)&&("ALLOWED"===(null===(r=null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===r?void 0:r.canProduceAudio)||"ALLOWED"===(null===(s=null===(a=null==e?void 0:e.self)||void 0===a?void 0:a.permissions)||void 0===s?void 0:s.canProduceScreenshare)||"ALLOWED"===(null===(n=null===(o=null==e?void 0:e.self)||void 0===o?void 0:o.permissions)||void 0===n?void 0:n.canProduceVideo))},h=e=>{var t,r,a,s,o,n,d,c;return!!i(e)&&("NOT_ALLOWED"!==(null===(r=null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===r?void 0:r.canProduceAudio)||"NOT_ALLOWED"!==(null===(s=null===(a=null==e?void 0:e.self)||void 0===a?void 0:a.permissions)||void 0===s?void 0:s.canProduceScreenshare)||"NOT_ALLOWED"!==(null===(n=null===(o=null==e?void 0:e.self)||void 0===o?void 0:o.permissions)||void 0===n?void 0:n.canProduceVideo)||(null===(c=null===(d=null==e?void 0:e.self)||void 0===d?void 0:d.permissions)||void 0===c?void 0:c.canLivestream))}},21237:(e,t,r)=>{r.d(t,{P:()=>o,s:()=>n});const a=720,s=1280,i=(e,t,r,a,s,i)=>{const o=s,n=i,d=Math.min(r/o,a/n);let c,l,h,u,p=o*d,v=n*d,m=1;return p<r&&(m=r/p),Math.abs(m-1)<1e-14&&v<a&&(m=a/v),p*=m,v*=m,h=o/(p/r),u=n/(v/a),c=.5*(o-h),l=.5*(n-u),c<0&&(c=0),l<0&&(l=0),h>o&&(h=o),u>n&&(u=n),[c,l,h,u,e,t,r,a]};var o;!function(e){e.CAMERA="CAMERA",e.MIC="MIC",e.END="END"}(o||(o={}));const n=new class{constructor(){this.tracks=[],this.sources=[],this.enabled=!1}isSupported(){return!!window.chrome&&document.pictureInPictureEnabled}cleanup(){this.isSupported()&&void 0!==document.exitPictureInPicture&&null!==document.pictureInPictureElement&&document.exitPictureInPicture(),this.canvas=void 0,this.video=void 0,this.tracks=[],this.request=void 0}createCanvas(){const e=document.createElement("canvas");e.height=a,e.width=s,this.canvas=e}setupEvents(e){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("hangup",(()=>{e(o.END)}))}mountAudioEvents(e){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglemicrophone",(()=>{e(o.MIC)}))}mountVideoEvents(e){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglecamera",(()=>{e(o.CAMERA)}))}unmountAudioEvents(){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglemicrophone",void 0)}unmountVideoEvents(){void 0!==navigator.mediaSession&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setActionHandler("togglecamera",void 0)}drawGrid(e,t,r){if(void 0===this.canvas)return;const o=this.canvas.getContext("2d");o.fillStyle="#000000",o.fillRect(0,0,s,a);let n=0,d=0;for(;n<715;){let a=0;for(;a<1275&&d<r;){const r=this.tracks[d],[s,c,l,h,u,p,v,m]=i(a,n,e,t,r.videoWidth,r.videoHeight);o.drawImage(r,s,c,l,h,u,p,v,m),d+=1,a+=e}n+=t}}paintCanvas(){const e=this.tracks.length,[t,r]=(e=>{switch(e){case 0:case 1:return[s,a];case 2:return[Math.floor(640),a];case 3:case 4:return[Math.floor(640),Math.floor(360)];default:return[Math.floor(426.6666666666667),Math.floor(360)]}})(e);this.drawGrid(t,r,e)}animate(){void 0!==this.tracks&&this.paintCanvas(),void 0!==this.request&&(this.request=requestAnimationFrame((()=>this.animate())))}create(e,t,r){this.cleanup(),this.createCanvas(),this.setupEvents(r);const i=document.createElement("video");i.height=a,i.width=s,i.autoplay=!0,i.srcObject=this.canvas.captureStream(24),this.video=i,this.video.onloadedmetadata=()=>{try{e(),this.video.onleavepictureinpicture=()=>{t()}}catch(r){t(r.getMessage())}},this.paintCanvas()}updateMediaSession(e,t){void 0!==navigator.mediaSession&&(e===o.CAMERA&&void 0!==navigator.mediaSession.setCameraActive&&navigator.mediaSession.setCameraActive(t),e===o.MIC&&void 0!==navigator.mediaSession.setMicrophoneActive&&navigator.mediaSession.setMicrophoneActive(t))}updateVideoSources(){const e=Object.values(this.sources).filter((e=>e.enabled)),t=[];e.map((e=>{t.push(e.element)})),this.tracks=t}enableSource(e){void 0!==this.sources[e]&&(this.sources[e].enabled=!0),this.updateVideoSources()}disableSource(e){void 0!==this.sources[e]&&(this.sources[e].enabled=!1),this.updateVideoSources()}addSource(e,t,r){this.sources[e]={element:t,enabled:r}}removeSource(e){delete this.sources[e]}removeAllSource(){this.sources=[]}enable(){this.enabled=!0,this.request=requestAnimationFrame((()=>this.animate())),this.video.requestPictureInPicture()}disable(){this.enabled=!1,cancelAnimationFrame(this.request),this.request=void 0,document.exitPictureInPicture()}}},46503:(e,t,r)=>{r.d(t,{o:()=>c,s:()=>d});var a=r(65733);const s=e=>!("isConnected"in e)||e.isConnected,i=((e,t)=>{let r;return(...a)=>{r&&clearTimeout(r),r=setTimeout((()=>{r=0,e(...a)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(s))}),2e3),o=e=>"function"==typeof e?e():e,n=(e,t)=>{const r=e.indexOf(t);r>=0&&(e[r]=e[e.length-1],e.length--)},{state:d,onChange:c}=((e,t)=>{const r=((e,t=((e,t)=>e!==t))=>{const r=o(e);let a=new Map(Object.entries(null!=r?r:{}));const s={dispose:[],get:[],set:[],reset:[]},i=()=>{var t;a=new Map(Object.entries(null!==(t=o(e))&&void 0!==t?t:{})),s.reset.forEach((e=>e()))},d=e=>(s.get.forEach((t=>t(e))),a.get(e)),c=(e,r)=>{const i=a.get(e);t(r,i,e)&&(a.set(e,r),s.set.forEach((t=>t(e,r,i))))},l="undefined"==typeof Proxy?{}:new Proxy(r,{get:(e,t)=>d(t),ownKeys:e=>Array.from(a.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>a.has(t),set:(e,t,r)=>(c(t,r),!0)}),h=(e,t)=>(s[e].push(t),()=>{n(s[e],t)});return{state:l,get:d,set:c,on:h,onChange:(t,r)=>{const a=h("set",((e,a)=>{e===t&&r(a)})),s=h("reset",(()=>r(o(e)[t])));return()=>{a(),s()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(h("set",t.set)),t.get&&e.push(h("get",t.get)),t.reset&&e.push(h("reset",t.reset)),t.dispose&&e.push(h("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{s.dispose.forEach((e=>e())),i()},reset:i,forceUpdate:e=>{const t=a.get(e);s.set.forEach((r=>r(e,t,t)))}}})(e,t);return r.use((()=>{if("function"!=typeof a.a)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const r=(0,a.a)();r&&((e,t,r)=>{const a=e.get(t);a?a.includes(r)||a.push(r):e.set(t,[r])})(e,t,r)},set:t=>{const r=e.get(t);r&&e.set(t,r.filter(a.f)),i(e)},reset:()=>{e.forEach((e=>e.forEach(a.f))),i(e)}}})()),r})({})}}]);